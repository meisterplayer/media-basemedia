{"version":3,"sources":["webpack:///webpack/bootstrap 4748c2ec16d31d9e55fb","webpack:///./index.js","webpack:///./src/js/BaseMedia.js"],"names":["BaseMedia","config","meister","player","supports","browser","isSamsung","window","MediaSource","push","item","Promise","resolve","indexOf","type","supported","errorCode","Meister","ErrorCodes","WRONG_TYPE","reject","getPlayerByType","trigger","info","metadata","name","src","currentSrc","title","bitrates","bitrate","currentIndex","one","isLive","duration","Infinity","on","_onPlayerTimeUpdate","bind","_onPlayerSeek","onRequestSeek","currentTime","relativePosition","e","targetTime","isNaN","timeOffset","blockSeekForward","Number","isFinite","MediaPlugin","registerPlugin","pluginName"],"mappings":"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","file":"dist/BaseMedia.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 2);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 4748c2ec16d31d9e55fb","import BaseMedia from './src/js/BaseMedia';\n\nexport default BaseMedia;\n\n\n\n// WEBPACK FOOTER //\n// ./index.js","class BaseMedia extends Meister.MediaPlugin {\n    constructor(config, meister) {\n        super(config, meister);\n\n        this.player = null;\n\n        this.supports = ['mp4', 'mp3', 'icecast'];\n\n        // HLS behaves like mp4 in samsung devices\n        if (this.meister.browser.isSamsung && !window.MediaSource) {\n            this.supports.push('m3u', 'm3u8');\n        }\n    }\n\n    static get pluginName() {\n        return 'BaseMedia';\n    }\n\n    isItemSupported(item) {\n        return new Promise((resolve) => {\n            if (this.supports.indexOf(item.type) === -1) {\n                return resolve({\n                    supported: false,\n                    errorCode: Meister.ErrorCodes.WRONG_TYPE,\n                });\n            }\n\n            return resolve({\n                supported: true,\n            });\n        });\n    }\n\n    get currentItem() {\n        return this.item;\n    }\n\n    process(item) {\n        return new Promise((resolve, reject) => {\n            this.player = this.meister.getPlayerByType('html5', item);\n\n            if (this.player) {\n                this.item = item;\n\n                // TODO: Shouldn't we check first if there is metadata before we trigger an UI event?\n                this.meister.trigger('uiEvent', { type: 'splash', info: this.item.metadata });\n\n                resolve(item);\n            } else {\n                reject(`${this.name}: Unable to play item ${item.src}, no suitable player available.`); //eslint-disable-line\n            }\n        });\n    }\n\n    load(item) {\n        super.load(item);\n\n        this.player.currentSrc = item.src;\n\n        // Ugly stuff to fix HLS in safari T_T\n        if (item.metadata) {\n            this.meister.trigger('itemMetadata', {\n                title: item.metadata.title,\n            });\n        }\n\n        if (item.type === 'm3u' || item.type === 'm3u8') {\n            this.meister.trigger('itemBitrates', {\n                bitrates: [{ metadata: { bitrate: 0 } }],\n                currentIndex: 0,\n            });\n        }\n\n\n        this.one('playerLoadedMetadata', () => {\n            let isLive = false;\n\n            const duration = this.player.duration;\n            if (duration === Infinity || duration === 0) {\n                isLive = true;\n            }\n\n            this.meister.trigger('itemTimeInfo', {\n                isLive,\n                duration,\n            });\n        });\n\n        this.on('_playerTimeUpdate', this._onPlayerTimeUpdate.bind(this));\n        this.on('_playerSeek', this._onPlayerSeek.bind(this));\n        this.on('requestSeek', this.onRequestSeek.bind(this));\n    }\n\n    unload() {\n        super.unload();\n\n        this.item = null;\n    }\n\n    _onPlayerTimeUpdate() {\n        this.meister.trigger('playerTimeUpdate', {\n            currentTime: this.meister.currentTime,\n            duration: this.meister.duration,\n        });\n    }\n\n    _onPlayerSeek() {\n        const currentTime = this.meister.currentTime;\n        const duration = this.meister.duration;\n        const relativePosition = currentTime / duration;\n\n        this.meister.trigger('playerSeek', {\n            relativePosition,\n            currentTime,\n            duration,\n        });\n    }\n\n    onRequestSeek(e) {\n        let targetTime;\n\n        if (!isNaN(e.relativePosition)) {\n            targetTime = e.relativePosition * this.meister.duration;\n        } else if (!isNaN(e.timeOffset)) {\n            targetTime = this.meister.currentTime + e.timeOffset;\n        }\n\n        // Check whether we are allowed to seek forward.\n        if (this.blockSeekForward && targetTime > this.meister.currentTime) { return; }\n\n        if (Number.isFinite(targetTime)) {\n            this.meister.currentTime = targetTime;\n        }\n    }\n}\n\nMeister.registerPlugin(BaseMedia.pluginName, BaseMedia);\nMeister.registerPlugin('baseMedia', BaseMedia);\n\nexport default BaseMedia;\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/BaseMedia.js"],"sourceRoot":""}